title: Suspicious Privilege Escalation Activity (T1068)
id: 9b134f21-b3c8-4dd1-aa53-65ac6f6a1068
status: experimental
description: Detects suspicious execution of processes running with SYSTEM integrity coming from unexpected parent processes, potentially indicating successful privilege escalation.
author: Dexter
references:
  - https://attack.mitre.org/techniques/T1068/

tags:
  - attack.privilege_escalation
  - attack.t1068
  - privilege-escalation

logsource:
  product: windows
  category: process_creation

detection:
  privileged_processes:
    IntegrityLevel:
      - System
      - High

  suspicious_parent:
    ParentImage|endswith:
      - "\\cmd.exe"
      - "\\powershell.exe"
      - "\\wscript.exe"
      - "\\cscript.exe"

  condition: privileged_processes and suspicious_parent

falsepositives:
  - Admin performing expected maintenance
  - Legitimate IT automation tools

level: high

fields:
  - Image
  - ParentImage
  - User
  - IntegrityLevel
  - CommandLine
  - Computer
